<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§å‰åœ‹ä¸­ 204 ç·šä¸Šè¯çµ¡ç°¿</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, setDoc, getDoc, collection, addDoc, onSnapshot, query, orderBy, deleteDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDDLO02aKJgvUa6Jk2GGslcWBhOtPHS4hE",
            authDomain: "homework-5072f.firebaseapp.com",
            projectId: "homework-5072f",
            storageBucket: "homework-5072f.firebasestorage.app",
            messagingSenderId: "927888465824",
            appId: "1:927888465824:web:7c6abc1c2212325900cec5",
            measurementId: "G-N9G0HZM1NT"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const students = [{id:1, name:"ä½•ç¿ä¿¡"}, {id:2, name:"é™³æŸç¿°"}, {id:3, name:"é»ƒæ˜ç’¿"}, {id:4, name:"é»ƒå‰‡å–„"}, {id:5, name:"é»ƒæšç¿°"}, {id:6, name:"åŠ‰æ ¢ç¿"}, {id:7, name:"æ—èŠŠæƒ "}, {id:8, name:"æ®µå­Ÿæ¶µ"}, {id:9, name:"æ´ªç…œæ™´"}, {id:10, name:"å¼µè‚²æ…ˆ"}, {id:11, name:"è¨±ä»¤éœ"}, {id:12, name:"å»–ä»¥æ™¨"}, {id:13, name:"åŠ‰æ™å¦¤"}];
        
        const sel = document.getElementById('student-sel');
        students.forEach(s => {
            const opt = document.createElement('option');
            opt.value = s.id;
            opt.textContent = `${s.id}. ${s.name}`;
            sel.appendChild(opt);
        });

        // --- ç°½åè¦–çª—é‚è¼¯ ---
        const sigOverlay = document.getElementById('sig-overlay');
        const canvas = document.getElementById('canvas');
        const pad = new SignaturePad(canvas);
        const previewImg = document.getElementById('sig-preview');
        let isEraser = false;

        window.openSignature = () => {
            sigOverlay.style.display = 'flex';
            resizeCanvas();
            document.body.style.overflow = 'hidden'; 
        };

        window.closeSignature = (save) => {
            if (save && !pad.isEmpty()) {
                previewImg.src = pad.toDataURL();
                previewImg.style.display = 'block';
                document.getElementById('sig-placeholder').style.display = 'none';
            }
            sigOverlay.style.display = 'none';
            document.body.style.overflow = 'auto';
        };

        window.toggleEraser = () => {
            isEraser = !isEraser;
            const btn = document.getElementById('eraser-btn');
            if (isEraser) {
                pad.compositeOperation = 'destination-out';
                btn.style.background = '#ff4444';
                btn.textContent = 'âœï¸ åˆ‡æ›ç•«ç­†';
            } else {
                pad.compositeOperation = 'source-over';
                btn.style.background = '#666';
                btn.textContent = 'ğŸ§½ æ©¡çš®æ“¦';
            }
        };

        window.changeWidth = (val) => {
            pad.minWidth = parseFloat(val);
            pad.maxWidth = parseFloat(val) + 2;
        };

        function resizeCanvas() {
            const ratio = Math.max(window.devicePixelRatio || 1, 1);
            canvas.width = canvas.offsetWidth * ratio;
            canvas.height = canvas.offsetHeight * ratio;
            canvas.getContext("2d").scale(ratio, ratio);
            pad.clear();
        }

        function getFormattedDate() {
            const now = new Date();
            const days = ['æ˜ŸæœŸæ—¥', 'æ˜ŸæœŸä¸€', 'æ˜ŸæœŸäºŒ', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸå››', 'æ˜ŸæœŸäº”', 'æ˜ŸæœŸå…­'];
            return `${now.toLocaleDateString('zh-TW')} ${days[now.getDay()]}`;
        }

        // --- ä¿®æ”¹å¾Œçš„æ™‚æ®µé‚è¼¯ ---
        function getStatisticsRange() {
            const now = new Date();
            const day = now.getDay(); 
            let start = new Date(now);
            let end = new Date(now);
            const setTime = (d, h) => { d.setHours(h, 0, 0, 0); return d.getTime(); };

            // åˆ¤æ–·æ˜¯å¦ç‚ºé€±äº”ä¸‹åˆ4é»åˆ°é€±ä¸€ä¸­åˆ12é»çš„å€é–“
            const isWeekendWindow = (day === 5 && now.getHours() >= 16) || (day === 6) || (day === 0) || (day === 1 && now.getHours() < 12);

            if (isWeekendWindow) {
                if (day === 5) start = setTime(start, 16);
                else if (day === 6) { start.setDate(start.getDate() - 1); start = setTime(start, 16); }
                else if (day === 0) { start.setDate(start.getDate() - 2); start = setTime(start, 16); }
                else if (day === 1) { start.setDate(start.getDate() - 3); start = setTime(start, 16); }
                end = new Date(start); 
                end.setDate(start.getDate() + 3); // æŒ‡å‘é€±ä¸€
                end = setTime(end, 12);           // æˆªæ­¢æ™‚é–“é€±ä¸€ 12:00
            } else {
                // å¹³æ—¥æ™‚æ®µï¼šä¸‹åˆ4é»åˆ°éš”å¤©ä¸­åˆ12é»
                if (now.getHours() >= 16) { 
                    start = setTime(start, 16);
                    end.setDate(end.getDate() + 1); 
                    end = setTime(end, 12);
                } else {
                    start.setDate(start.getDate() - 1); 
                    start = setTime(start, 16);
                    end = setTime(new Date(now), 12);
                }
            }
            return { start, end };
        }

        let currentHomeworkContent = ""; // æš«å­˜ç›®å‰çš„åŠŸèª²å…§å®¹

        onSnapshot(doc(db, "configs", "today_homework"), (docSnap) => {
            if (docSnap.exists()) {
                currentHomeworkContent = docSnap.data().content || "";
                document.getElementById('hw-content').innerText = currentHomeworkContent;
                document.getElementById('hw-date').innerText = docSnap.data().date || getFormattedDate();
                
                // å¦‚æœå¾Œå°æ˜¯é–‹å•Ÿçš„ï¼Œä¸”è¼¸å…¥æ¡†æ˜¯ç©ºçš„ï¼ˆæˆ–è€…æ­£åœ¨ç·¨è¼¯ï¼‰ï¼Œé€™è£¡å¯ä»¥é¸æ“‡æ˜¯å¦å³æ™‚æ›´æ–°è¼¸å…¥æ¡†
                // ç‚ºäº†æ–¹ä¾¿ï¼Œæˆ‘å€‘è¨­å®šï¼šç•¶å¾Œå°é–‹å•Ÿæ™‚ï¼Œå¦‚æœè¼¸å…¥æ¡†æ²’æœ‰è¢«ä¿®æ”¹éï¼Œå°±è‡ªå‹•å¡«å…¥æœ€æ–°å€¼
                const inputArea = document.getElementById('hw-input');
                if (inputArea && inputArea.value === "") {
                     inputArea.value = currentHomeworkContent;
                }
            }
        });

        window.saveData = async () => {
            const sid = sel.value;
            if(!sid || previewImg.style.display === 'none') return alert("è«‹é¸å–åº§è™Ÿä¸¦å®Œæˆæ‰‹å¯«ç°½å");
            try {
                await addDoc(collection(db, "signatures"), {
                    sid: sid,
                    name: students.find(s => s.id == sid).name,
                    comment: document.getElementById('comment').value,
                    sig: previewImg.src,
                    time: new Date().toLocaleString('zh-TW'),
                    timestamp: Date.now()
                });
                alert("å„²å­˜æˆåŠŸï¼");
                pad.clear();
                previewImg.style.display = 'none';
                document.getElementById('sig-placeholder').style.display = 'block';
                document.getElementById('comment').value = '';
            } catch(e) { alert("å„²å­˜å¤±æ•—"); }
        };

        window.updateHW = async () => {
            const val = document.getElementById('hw-input').value;
            if(!val) return alert("è«‹è¼¸å…¥å…§å®¹");
            try {
                await addDoc(collection(db, "history_homework"), {
                    date: document.getElementById('hw-date').innerText,
                    content: document.getElementById('hw-content').innerText,
                    timestamp: Date.now()
                });
                await setDoc(doc(db, "configs", "today_homework"), {
                    content: val,
                    date: getFormattedDate()
                });
                // æ›´æ–°å¾Œä¸éœ€è¦æ¸…ç©ºï¼Œæ–¹ä¾¿ç¹¼çºŒä¿®æ”¹
                // document.getElementById('hw-input').value = ''; 
                alert("åŠŸèª²å·²æ›´æ–°ï¼");
            } catch(e) { alert("æ›´æ–°å¤±æ•—"); }
        };

        window.loginAdmin = () => {
            const pw = prompt("è«‹è¼¸å…¥ç®¡ç†å¯†ç¢¼ï¼š");
            if (pw === "0904") {
                // æ•™å¸«å®Œæ•´å¾Œå°
                document.getElementById('admin-panel').style.display = 'block';
                document.getElementById('teacher-extra').style.display = 'block';
                
                // è‡ªå‹•å¸¶å…¥ç›®å‰åŠŸèª²å…§å®¹åˆ°è¼¸å…¥æ¡†
                document.getElementById('hw-input').value = currentHomeworkContent;

                window.initAdminData(); 
                document.getElementById('admin-panel').scrollIntoView({ behavior: 'smooth' });
            } else if (pw === "0214") {
                // å­¸ç”Ÿå¹¹éƒ¨å¾Œå° (åƒ…èƒ½è¼¸å…¥åŠŸèª²)
                document.getElementById('admin-panel').style.display = 'block';
                document.getElementById('teacher-extra').style.display = 'none'; // éš±è—çµ±è¨ˆèˆ‡æ­·å²
                
                // è‡ªå‹•å¸¶å…¥ç›®å‰åŠŸèª²å…§å®¹åˆ°è¼¸å…¥æ¡†
                document.getElementById('hw-input').value = currentHomeworkContent;
                
                document.getElementById('admin-panel').scrollIntoView({ behavior: 'smooth' });
            } else {
                alert("å¯†ç¢¼éŒ¯èª¤ï¼");
            }
        };

        window.initAdminData = () => {
            onSnapshot(query(collection(db, "history_homework"), orderBy("timestamp", "desc")), (snap) => {
                document.getElementById('admin-history-manage').innerHTML = snap.docs.map(d => `
                    <div class="edit-card">
                        <small>${d.data().date}</small>
                        <textarea id="edit-${d.id}" style="width:100%; margin:5px 0;">${d.data().content}</textarea>
                        <button onclick="window.saveEditHW('${d.id}')">å„²å­˜ä¿®æ”¹</button>
                        <button onclick="window.deleteHW('${d.id}')" style="color:red;">åˆªé™¤</button>
                    </div>
                `).join('');
            });

            onSnapshot(query(collection(db, "signatures"), orderBy("timestamp", "desc")), (snap) => {
                const range = getStatisticsRange();
                const allData = snap.docs.map(d => ({id: d.id, ...d.data()}));
                const statsRecords = allData.filter(r => r.timestamp >= range.start && r.timestamp < range.end);
                const signedIds = statsRecords.map(r => parseInt(r.sid));
                const unsigned = students.filter(s => !signedIds.includes(s.id));

                document.getElementById('stats-area').innerHTML = `
                    <div style="background:#e3f2fd; padding:15px; border-radius:8px; margin-bottom:15px; border-left:5px solid #2196F3;">
                        <b style="color:#1565C0;">ğŸ“Š çµ±è¨ˆæ™‚æ®µï¼š</b><br>
                        ${new Date(range.start).toLocaleString()} ~ ${new Date(range.end).toLocaleString()}
                    </div>
                    <div style="background:#fff1f1; padding:15px; border-radius:8px; border-left:5px solid #f44336;">
                        <b style="color:#c62828;">âŒ æœ¬æ™‚æ®µæœªç°½å (${unsigned.length}äºº)ï¼š</b><br>
                        <p style="margin-top:8px; font-size:1.1em;">${unsigned.length > 0 ? unsigned.map(s => s.name).join('ã€') : 'âœ¨ å…¨ç­å·²ç°½å'}</p>
                    </div>`;

                // --- ä¿®æ”¹è™•ï¼šå¢åŠ æ‰¹é‡åˆªé™¤çš„æ§åˆ¶å€èˆ‡ Checkbox ---
                const batchControlHTML = `
                    <div style="margin-bottom: 10px; padding: 10px; background: #eee; border-radius: 4px; display: flex; justify-content: space-between; align-items: center;">
                        <label style="cursor:pointer; display:flex; align-items:center; gap:5px; margin:0;">
                            <input type="checkbox" id="selectAllSigs" onchange="window.toggleAllSigs(this)" style="transform: scale(1.3);"> 
                            å…¨é¸
                        </label>
                        <button onclick="window.deleteSelectedSigs()" style="background: #d32f2f; color: white; border: none; padding: 8px 15px; border-radius: 4px; cursor: pointer; font-weight: bold;">ğŸ—‘ï¸ åˆªé™¤é¸å–é …ç›®</button>
                    </div>
                `;

                const listHTML = allData.map(d => {
                    const isOutside = (d.timestamp < range.start || d.timestamp >= range.end);
                    return `
                    <div class="record-card" style="${isOutside ? 'opacity:0.6; border-style:dashed; background:#fafafa;' : 'border-left:4px solid #4caf50;'}">
                        <div style="display:flex; justify-content:space-between; align-items:center;">
                            <b>${d.sid}. ${d.name}</b>
                            <input type="checkbox" class="sig-checkbox" value="${d.id}" style="transform: scale(1.5); cursor: pointer;">
                        </div>
                        ${isOutside ? '<span style="color:#999; font-size:0.8em;">[éæœ¬æ¬¡çµ±è¨ˆ]</span><br>' : ''}
                        <small style="color:#888;">${d.time}</small><br>
                        <div style="margin:5px 0; color:#444;">ç•™è¨€ï¼š${d.comment || 'ç„¡'}</div>
                        <img src="${d.sig}" style="width:100%; border:1px solid #eee; background:#fff; margin-top:5px;">
                        <div style="text-align:right; margin-top:5px;">
                            <button onclick="window.deleteSig('${d.id}')" style="color:#666; background:none; border:none; cursor:pointer; font-size:12px; text-decoration:underline;">å€‹åˆ¥åˆªé™¤</button>
                        </div>
                    </div>`;
                }).join('');

                document.getElementById('records-list').innerHTML = batchControlHTML + listHTML;
            });
        };

        // --- æ–°å¢ï¼šæ‰¹é‡æ“ä½œåŠŸèƒ½ ---
        window.toggleAllSigs = (source) => {
            const checkboxes = document.querySelectorAll('.sig-checkbox');
            checkboxes.forEach(cb => cb.checked = source.checked);
        };

        window.deleteSelectedSigs = async () => {
            const checkedBoxes = document.querySelectorAll('.sig-checkbox:checked');
            if (checkedBoxes.length === 0) return alert("è«‹å…ˆé¸å–è¦åˆªé™¤çš„é …ç›®");
            
            if (!confirm(`âš ï¸ ç¢ºå®šè¦æ°¸ä¹…åˆªé™¤é¸å–çš„ ${checkedBoxes.length} ç­†ç°½åå—ï¼Ÿ\næ­¤å‹•ä½œç„¡æ³•å¾©åŸï¼`)) return;

            try {
                // ä½¿ç”¨ Promise.all å¹³è¡Œåˆªé™¤
                const deletePromises = Array.from(checkedBoxes).map(cb => deleteDoc(doc(db, "signatures", cb.value)));
                await Promise.all(deletePromises);
                alert("åˆªé™¤æˆåŠŸï¼");
                // åˆªé™¤å¾Œè‡ªå‹•å–æ¶ˆå…¨é¸ç‹€æ…‹
                const selectAllBox = document.getElementById('selectAllSigs');
                if(selectAllBox) selectAllBox.checked = false;
            } catch (e) {
                alert("åˆªé™¤å¤±æ•—ï¼š" + e.message);
            }
        };

        window.saveEditHW = async (id) => {
            const newContent = document.getElementById(`edit-${id}`).value;
            await updateDoc(doc(db, "history_homework", id), { content: newContent });
            alert("å·²ä¿®æ­£");
        };
        window.deleteHW = async (id) => {
            if(confirm("ç¢ºå®šåˆªé™¤åŠŸèª²æ­·å²ï¼Ÿ")) await deleteDoc(doc(db, "history_homework", id));
        };
        window.deleteSig = async (id) => {
            if(confirm("ç¢ºå®šæ°¸ä¹…åˆªé™¤æ­¤ç°½åç´€éŒ„ï¼Ÿ")) await deleteDoc(doc(db, "signatures", id));
        };
        window.toggleHistory = () => {
            const box = document.getElementById('history-box');
            if (box.style.display === 'block') {
                box.style.display = 'none';
            } else {
                const q = query(collection(db, "history_homework"), orderBy("timestamp", "desc"));
                onSnapshot(q, (snapshot) => {
                    box.innerHTML = snapshot.docs.map(d => `<div class="hist-item"><b>${d.data().date}</b><br>${d.data().content}</div>`).join('');
                });
                box.style.display = 'block';
            }
        };

        window.onresize = resizeCanvas;
    </script>

    <style>
        :root { --muji-bg: #f2f0eb; --blackboard-green: #2c4c3e; --chalk-white: #fdfdfd; --muji-charcoal: #333333; }
        * { box-sizing: border-box; }
        body { font-family: 'Noto Sans TC', sans-serif; background-color: var(--muji-bg); color: var(--muji-charcoal); margin: 0; padding: 15px; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 25px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .blackboard { background-color: var(--blackboard-green); border: 12px solid #5d4037; border-radius: 4px; padding: 20px; text-align: center; margin-top: 20px; }
        .bb-title { color: #ffd54f; font-size: 1.8em; font-weight: 700; }
        .bb-date { color: rgba(255,255,255,0.8); margin-bottom: 10px; border-bottom: 1px dashed rgba(255,255,255,0.3); padding-bottom: 10px; }
        .homework-content { color: var(--chalk-white); font-size: 1.3em; line-height: 1.6; text-align: left; white-space: pre-wrap; min-height: 80px; }
        .btn { background-color: var(--muji-charcoal); color: white; border: none; padding: 18px; cursor: pointer; width: 100%; font-size: 20px; border-radius: 6px; font-weight: 700; margin-top: 10px; }
        .btn-history { background: none; border: 2px solid #888; color: #888; font-size: 16px; height: 50px; }
        #history-box { display: none; padding: 15px; background: #f9f9f9; border-radius: 4px; border: 1px solid #ddd; margin-top: 10px; }
        .hist-item { border-bottom: 1px solid #eee; padding: 10px 0; font-size: 0.9em; }
        .admin-area { display: none; margin-top: 40px; padding: 20px; background: #eef2f3; border-radius: 8px; border: 2px solid #ccc; }
        .record-card, .edit-card { background: white; border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .sig-preview-box { border: 2px dashed #bbb; background: #fafafa; border-radius: 6px; min-height: 120px; display: flex; align-items: center; justify-content: center; cursor: pointer; margin-top: 10px; overflow: hidden; }
        .sig-preview-box img { max-height: 150px; }
        #sig-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 1000; display: none; flex-direction: column; }
        .sig-header { padding: 15px; background: #f2f0eb; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #ddd; }
        .sig-controls { padding: 10px; background: #eee; display: flex; flex-wrap: wrap; gap: 10px; align-items: center; justify-content: center; }
        .sig-canvas-wrap { flex: 1; position: relative; background: #fff; cursor: crosshair; }
        canvas { width: 100%; height: 100%; touch-action: none; }
        .control-btn { padding: 8px 15px; border: none; border-radius: 4px; color: white; cursor: pointer; font-weight: bold; }
        label { font-weight: 700; display: block; margin-top: 15px; }
    </style>
</head>
<body>
<div class="container">
    <div style="text-align: center;">
        <h2 style="margin:0;">å¤§å‰åœ‹ä¸­ äºŒå¹´å››ç­</h2>
        <h1 style="margin:5px 0 20px 0;">ç·šä¸Šè¯çµ¡ç°¿</h1>
    </div>

    <div class="blackboard">
        <div class="bb-title">ä»Šæ—¥åŠŸèª²</div>
        <div class="bb-date" id="hw-date">è¼‰å…¥ä¸­...</div>
        <div id="hw-content" class="homework-content">è¼‰å…¥ä¸­...</div>
    </div>

    <button class="btn btn-history" onclick="toggleHistory()">ğŸ“‚ æŸ¥çœ‹æ­·å²åŠŸèª² (å±•é–‹/æ”¶èµ·)</button>
    <div id="history-box"></div>

    <hr style="margin: 30px 0; border: 0; border-top: 2px solid #eee;">

    <h3 style="border-left: 6px solid #333; padding-left: 12px;">å®¶é•·ç°½åå€åŸŸ</h3>
    
    <label>1. é¸æ“‡å­¸ç”Ÿåº§è™Ÿ</label>
    <select id="student-sel" style="width:100%; padding:14px; font-size:18px; border-radius:6px; border:1px solid #ccc;"></select>

    <label>2. å®¶é•·ç•™è¨€ (é¸å¡«)</label>
    <textarea id="comment" rows="2" style="width:100%; padding:14px; font-size:18px; border-radius:6px; border:1px solid #ccc;"></textarea>

    <label>3. å®¶é•·æ‰‹å¯«ç°½å</label>
    <div class="sig-preview-box" onclick="openSignature()">
        <span id="sig-placeholder" style="color: #888;">é»æ“Šæ­¤è™•é–‹å•Ÿç°½åç•«é¢</span>
        <img id="sig-preview" src="" style="display: none;">
    </div>

    <button class="btn" onclick="saveData()">ç¢ºèªå„²å­˜ä¸¦é€å‡º</button>

    <button onclick="loginAdmin()" style="margin-top:80px; opacity:0.1; background:none; border:none; width:100%; cursor:default;">ç®¡ç†</button>

    <div id="admin-panel" class="admin-area">
        <h2 style="text-align:center; color:#333;">æ•™å¸«/å¹¹éƒ¨ç®¡ç†å¾Œå°</h2>
        <label>ç™¼å¸ƒæ–°åŠŸèª²å…§å®¹</label>
        <textarea id="hw-input" rows="4" style="width:100%; padding:10px; margin-bottom:10px; border-radius:6px; border:1px solid #bbb;"></textarea>
        <button class="btn" style="background:#444;" onclick="updateHW()">æ›´æ–°é»‘æ¿å…§å®¹</button>
        <div id="teacher-extra">
            <hr style="margin:25px 0;">
            <h3>ğŸ“Š å®¶é•·ç°½åçµ±è¨ˆ</h3>
            <div id="stats-area">æ­£åœ¨è¨ˆç®—çµ±è¨ˆæ•¸æ“š...</div>
            <h3 style="margin-top:30px;">ğŸ“‹ å®Œæ•´æ­·å²ç°½åç´€éŒ„</h3>
            <div id="records-list"></div>
            <hr style="margin:25px 0;">
            <h3>âœï¸ ä¿®æ­£æ­·å²åŠŸèª²</h3>
            <div id="admin-history-manage"></div>
        </div>
    </div>
</div>

<div id="sig-overlay">
    <div class="sig-header">
        <button onclick="closeSignature(false)" style="background: #ccc; border:none; padding:10px; border-radius:5px;">å–æ¶ˆ</button>
        <strong style="font-size: 1.2em;">å®¶é•·ç°½åç•«é¢</strong>
        <button onclick="closeSignature(true)" style="background: #333; color:white; border:none; padding:10px 20px; border-radius:5px;">å®Œæˆ</button>
    </div>
    <div class="sig-controls">
        <div style="display:flex; align-items:center; gap:5px;">
            <small>ç²—ç´°:</small>
            <input type="range" min="1" max="10" value="3" oninput="changeWidth(this.value)">
        </div>
        <button id="eraser-btn" class="control-btn" style="background: #666;" onclick="toggleEraser()">ğŸ§½ æ©¡çš®æ“¦</button>
        <button class="control-btn" style="background: #888;" onclick="pad.clear()">ğŸ—‘ï¸ å…¨éƒ¨æ¸…é™¤</button>
    </div>
    <div class="sig-canvas-wrap">
        <canvas id="canvas"></canvas>
    </div>
    <div style="padding: 10px; text-align: center; color: #666; font-size: 0.9em; background: #f9f9f9;">
        è«‹åœ¨ç©ºç™½è™•æ›¸å¯«å§“å
    </div>
</div>

</body>
</html>
