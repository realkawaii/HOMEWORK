<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§å‰åœ‹ä¸­ 204 é›»å­è¯çµ¡ç°¿</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
    <style>
        :root { --muji-bg: #f2f0eb; --muji-stone: #e0dbd1; --muji-charcoal: #333333; --muji-accent: #8c8c8c; }
        * { box-sizing: border-box; } /* ç¢ºä¿å¯¬åº¦è¨ˆç®—æ­£ç¢ºï¼Œé˜²æ­¢è·‘ç‰ˆ */
        body { font-family: 'Noto Sans TC', sans-serif; background-color: var(--muji-bg); color: var(--muji-charcoal); margin: 0; padding: 15px; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 20px; border-radius: 4px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        h1, h2, h3, h4 { text-align: center; font-weight: 500; }
        .school-info { font-size: 0.8em; color: var(--muji-accent); text-align: center; letter-spacing: 2px; margin-bottom: 5px; }
        .section { border-bottom: 1px solid var(--muji-stone); padding: 20px 0; }
        .homework-box { background: #fafafa; padding: 15px; border-radius: 4px; border-left: 5px solid var(--muji-accent); min-height: 60px; white-space: pre-wrap; margin-bottom: 10px; line-height: 1.6; }
        .history-btn { background: none; border: 1px solid var(--muji-stone); color: var(--muji-accent); padding: 8px 15px; cursor: pointer; border-radius: 4px; font-size: 0.9em; width: 100%; }
        
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 8px; font-weight: 500; font-size: 0.95em; }
        select, textarea { width: 100%; padding: 12px; border: 1px solid var(--muji-stone); border-radius: 4px; font-size: 16px; font-family: inherit; }
        
        /* ç°½åæ¿å€åŸŸ */
        .signature-wrapper { border: 1px solid var(--muji-stone); background: #fff; width: 100%; border-radius: 4px; position: relative; }
        canvas { width: 100%; height: 200px; touch-action: none; display: block; }
        
        .btn { background-color: var(--muji-charcoal); color: white; border: none; padding: 14px; cursor: pointer; width: 100%; font-size: 16px; border-radius: 4px; margin-top: 10px; }
        .btn:hover { opacity: 0.9; }

        /* è€å¸«ç«¯é¡¯ç¤ºå¡ç‰‡ */
        .admin-area { display: none; background: #f9f9f9; padding: 15px; border: 1px solid var(--muji-stone); margin-top: 20px; border-radius: 4px; }
        .record-card { background: white; border: 1px solid var(--muji-stone); padding: 15px; margin-bottom: 15px; border-radius: 4px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .record-header { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 0.9em; border-bottom: 1px solid #eee; padding-bottom: 5px; }
        .comment-display { background: #fdfdfd; padding: 10px; border-radius: 4px; border: 1px solid #f0f0f0; margin: 10px 0; font-size: 0.95em; }
        .sig-image-box { text-align: center; background: #fff; border: 1px solid #f0f0f0; padding: 5px; }
        .sig-image-box img { max-width: 100%; height: auto; display: block; margin: 0 auto; }
        .delete-btn { color: #d9534f; cursor: pointer; font-size: 0.85em; background: none; border: none; text-decoration: underline; margin-top: 10px; width: 100%; text-align: right; }
        
        .unsigned-box { background: #fff1f1; border: 1px solid #f5c6cb; color: #721c24; padding: 12px; border-radius: 4px; margin-bottom: 15px; font-size: 0.9em; line-height: 1.5; }
    </style>
</head>
<body>

<div class="container">
    <div class="school-info">å¤§å‰åœ‹ä¸­ äºŒå¹´å››ç­</div>
    <h1>é›»å­è¯çµ¡ç°¿</h1>

    <div class="section">
        <h2 id="hw-title">ä»Šæ—¥åŠŸèª²</h2>
        <div id="homework-display" class="homework-box">è®€å–ä¸­...</div>
        <button class="history-btn" onclick="showHistory()">ğŸ“‚ æŸ¥çœ‹ä¹‹å‰åŠŸèª²</button>
    </div>

    <div class="section">
        <h2>å®¶é•·ç°½å</h2>
        <div class="input-group">
            <label>1. é¸æ“‡å­¸ç”Ÿåº§è™Ÿ</label>
            <select id="student-select">
                <option value="">è«‹é»æ“Šé¸æ“‡</option>
            </select>
        </div>
        <div class="input-group">
            <label>2. æƒ³å°è€å¸«èªªçš„è©±</label>
            <textarea id="parent-comment" rows="2" placeholder="é¸å¡«"></textarea>
        </div>
        <div class="input-group">
            <label>3. å®¶é•·æ‰‹å¯«ç°½å</label>
            <div class="signature-wrapper">
                <canvas id="signature-pad"></canvas>
            </div>
            <button onclick="signaturePad.clear()" style="font-size:12px; background:none; border:none; color:var(--muji-accent); text-decoration:underline; cursor:pointer; margin-top:5px;">æ¸…é™¤é‡ç°½</button>
        </div>
        <button class="btn" onclick="saveData()">å„²å­˜ç°½åä¸¦é€å‡º</button>
    </div>

    <button onclick="authAdmin()" style="background:none; border:none; color:#ccc; width:100%; margin-top:60px; cursor:pointer; font-size:0.7em;">è€å¸«ç«¯ç®¡ç†ç™»å…¥</button>

    <div id="admin-panel" class="admin-area">
        <h3>è€å¸«ç®¡ç†å¾Œå°</h3>
        <div class="input-group">
            <label>ç™¼å¸ƒæ–°åŠŸèª²</label>
            <textarea id="admin-hw-input" rows="3" placeholder="è«‹åœ¨æ­¤è¼¸å…¥ä»Šæ—¥åŠŸèª²..."></textarea>
            <button class="btn" style="background:#666;" onclick="publishHomework()">ç™¼å¸ƒä¸¦ç•™å­˜æ­·å²</button>
        </div>
        <hr>
        <h4>ç°½åçµ±è¨ˆèˆ‡å…§å®¹</h4>
        <div id="stats-area"></div>
        <div id="records-list">
            </div>
    </div>
</div>

<script>
    const students = [
        {id:1, name:"ä½•ç¿ä¿¡"}, {id:2, name:"é™³æŸç¿°"}, {id:3, name:"é»ƒæ˜ç’¿"},
        {id:4, name:"é»ƒå‰‡å–„"}, {id:5, name:"é»ƒæšç¿°"}, {id:6, name:"åŠ‰æ ¢ç¿"},
        {id:7, name:"æ—èŠŠæƒ "}, {id:8, name:"æ®µå­Ÿæ¶µ"}, {id:9, name:"æ´ªç…œæ™´"},
        {id:10, name:"å¼µè‚²æ…ˆ"}, {id:11, name:"è¨±ä»¤éœ"}, {id:12, name:"å»–ä»¥æ™¨"},
        {id:13, name:"åŠ‰æ™å¦¤"}
    ];

    // åˆå§‹åŒ–ä¸‹æ‹‰é¸å–®
    const sel = document.getElementById('student-select');
    students.forEach(s => sel.innerHTML += `<option value="${s.id}">${s.id}. ${s.name}</option>`);

    // åˆå§‹åŒ–ç°½åæ¿
    const canvas = document.getElementById('signature-pad');
    const signaturePad = new SignaturePad(canvas);
    
    // è‡ªå‹•èª¿æ•´ç•«å¸ƒå¤§å°
    function resizeCanvas() {
        const ratio = Math.max(window.devicePixelRatio || 1, 1);
        canvas.width = canvas.offsetWidth * ratio;
        canvas.height = canvas.offsetHeight * ratio;
        canvas.getContext("2d").scale(ratio, ratio);
        signaturePad.clear();
    }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    function getToday() { return new Date().toLocaleDateString('zh-TW').replace(/\//g, '-'); }
    document.getElementById('hw-title').innerText = `ä»Šæ—¥åŠŸèª² (${getToday()})`;

    // --- åŠŸèƒ½å‡½å¼ ---
    function saveData() {
        const sId = document.getElementById('student-select').value;
        if (!sId || signaturePad.isEmpty()) return alert("è«‹é¸æ“‡å­¸ç”Ÿä¸¦å®Œæˆç°½åå–”ï¼");

        const data = {
            id: Date.now(),
            studentName: students.find(s => s.id == sId).name,
            comment: document.getElementById('parent-comment').value,
            signature: signaturePad.toDataURL(),
            date: getToday(),
            time: new Date().toLocaleTimeString('zh-TW', {hour12:false})
        };

        alert("å·²æˆåŠŸå„²å­˜ï¼\n" + data.studentName + " çš„å®¶é•·å·²å®Œæˆç°½åã€‚");
        signaturePad.clear();
        document.getElementById('parent-comment').value = '';
    }

    function authAdmin() {
        if(prompt("è«‹è¼¸å…¥å¯†ç¢¼ï¼š") === "0904") {
            document.getElementById('admin-panel').style.display = 'block';
            showFakeData(); // é€™è£¡å…ˆè·‘æ¨¡æ“¬è³‡æ–™çµ¦æ‚¨çœ‹æ•ˆæœ
        }
    }

    // æ¨¡æ“¬è€å¸«çœ‹åˆ°çš„å…§å®¹
    function showFakeData() {
        const recordsList = document.getElementById('records-list');
        // æ¨¡æ“¬ä¸€ç­†å·²ç°½åçš„è³‡æ–™
        const fakeData = [{
            id: "123",
            studentId: "7",
            studentName: "æ—èŠŠæƒ ",
            time: "19:30:45",
            comment: "é‚±è€å¸«æ‚¨å¥½ï¼ŒèŠŠæƒ ä»Šå¤©å–‰åš¨æœ‰é»ç—›ï¼Œéº»ç…©è€å¸«å¤šæé†’å¥¹å–æ°´ï¼Œè¬è¬ï¼",
            signature: canvas.toDataURL() // æŠ“ç›®å‰ç•«å¸ƒç•¶ç¯„ä¾‹
        }];

        recordsList.innerHTML = '';
        fakeData.forEach(r => {
            recordsList.innerHTML += `
                <div class="record-card">
                    <div class="record-header">
                        <strong>åº§è™Ÿ ${r.studentId} ${r.studentName}</strong>
                        <span>${r.time}</span>
                    </div>
                    <div class="comment-display">${r.comment}</div>
                    <div class="sig-image-box">
                        <img src="${r.signature}">
                    </div>
                    <button class="delete-btn" onclick="this.parentElement.remove()">[ åˆªé™¤æ­¤ç­†è¨˜éŒ„ ]</button>
                </div>
            `;
        });
        
        document.getElementById('stats-area').innerHTML = `<div class="unsigned-box">ç›®å‰æ¨¡æ“¬ 1 äººå·²ç°½åï¼Œ12 äººæœªç°½åã€‚</div>`;
    }

    function publishHomework() {
        const val = document.getElementById('admin-hw-input').value;
        if(!val) return alert("è«‹è¼¸å…¥å…§å®¹");
        document.getElementById('homework-display').innerText = val;
        alert("ä»Šæ—¥åŠŸèª²å·²æ›´æ–°ï¼");
    }

    function showHistory() {
        const d = prompt("è«‹è¼¸å…¥æ—¥æœŸ (YYYY-MM-DD)ï¼š", getToday());
        if(d) alert("æ­£åœ¨æœå°‹ " + d + " çš„æ­·å²åŠŸèª²...");
    }
</script>
</body>
</html>
